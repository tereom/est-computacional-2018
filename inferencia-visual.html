<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018." />
  <meta name="github-repo" content="tereom/est-computacional-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018." />
  

<meta name="author" content="María Teresa Ortiz">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="modelos-graficos-y-simulacion-predictiva.html">
<link rel="next" href="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.5/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.5/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.5/profvis.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificacion"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduccion-a-visualizacion.html"><a href="introduccion-a-visualizacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a visualización</a><ul>
<li class="chapter" data-level="" data-path="introduccion-a-visualizacion.html"><a href="introduccion-a-visualizacion.html#el-cuarteto-de-ascombe"><i class="fa fa-check"></i>El cuarteto de Ascombe</a></li>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-de-datos-en-la-estadistica"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#principios-generales-del-diseno-analitico"><i class="fa fa-check"></i>Principios generales del diseño analítico</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#tecnicas-de-visualizacion"><i class="fa fa-check"></i>Técnicas de visualización</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#indicadores-de-calidad-grafica"><i class="fa fa-check"></i>Indicadores de calidad gráfica</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#factor-de-engano-chartjunk-y-pies"><i class="fa fa-check"></i>Factor de engaño, chartjunk y pies</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#series-de-tiempo-y-promedio-de-45"><i class="fa fa-check"></i>Series de tiempo y promedio de 45</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#pequenos-multiplos-y-densidad-grafica"><i class="fa fa-check"></i>Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#tinta-de-datos"><i class="fa fa-check"></i>Tinta de datos</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#percepcion-de-escala"><i class="fa fa-check"></i>Percepción de escala</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#minard"><i class="fa fa-check"></i>Minard</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion-a-r-y-al-paquete-ggplot2.html"><a href="introduccion-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-analisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-agrupacion-de-datos.html"><a href="manipulacion-y-agrupacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li><a href="transformacion-de-datos.html#separa-aplica-combina-split-apply-combine">Separa-aplica-combina (<em>split-apply-combine</em>)</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ejemplos-y-lectura-de-datos"><i class="fa fa-check"></i>Ejemplos y lectura de datos</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#summarise-y-resumenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#operador-pipeline"><i class="fa fa-check"></i>Operador pipeline</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-mas-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#mas-de-un-tipo-de-observacion-en-una-misma-tabla"><i class="fa fa-check"></i>Mas de un tipo de observación en una misma tabla</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-esta-almacenada-en-multiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones.html"><a href="funciones.html"><i class="fa fa-check"></i><b>4.1</b> Funciones</a><ul>
<li class="chapter" data-level="" data-path="funciones.html"><a href="funciones.html#estructura-de-una-funcion"><i class="fa fa-check"></i>Estructura de una función</a></li>
<li class="chapter" data-level="" data-path="funciones.html"><a href="funciones.html#observaciones-del-uso-de-funciones"><i class="fa fa-check"></i>Observaciones del uso de funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteracion.html"><a href="iteracion.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeno"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduccion-a-probabilidad.html"><a href="introduccion-a-probabilidad.html"><i class="fa fa-check"></i><b>5</b> Introducción a probabilidad</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extension-a-proporcion.html"><a href="probabilidad-como-extension-a-proporcion.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión a proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretacion-frecuentista-de-probabilidad.html"><a href="interpretacion-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a></li>
<li class="chapter" data-level="5.3" data-path="simulacion-para-el-calculo-de-probabilidades.html"><a href="simulacion-para-el-calculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html"><i class="fa fa-check"></i><b>5.4</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="5.4.1" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html#propiedades-de-la-funcion-de-probabilidad"><i class="fa fa-check"></i><b>5.4.1</b> Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.5</b> Variables aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-parametrico.html"><a href="bootstrap-no-parametrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#funcion-de-distribucion-empirica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parametros-y-estadisticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estandar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#variacion-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#mas-alla-de-muestras-aleatorias-simples"><i class="fa fa-check"></i>Más alla de muestras aleatorias simples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.4</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.5" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.5</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoria-basica-de-simulacion.html"><a href="teoria-basica-de-simulacion.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#aceptacion-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="7.3.1" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#variables-aleatorias-continuas-1"><i class="fa fa-check"></i><b>7.3.1</b> Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#aceptacion-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-modelos.html"><a href="simulacion-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulacion-de-modelos.html"><a href="simulacion-de-modelos.html#para-que-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-graficos-y-simulacion-predictiva.html"><a href="modelos-graficos-y-simulacion-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipotesis-tipicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#mas-alla-que-permutacion"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html"><a href="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html"><i class="fa fa-check"></i><b>8.4</b> Simulación para cálculo de tamaño de muestra/poder estadístico</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-parametrica.html"><a href="inferencia-parametrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="maxima-verosimilitud.html"><a href="maxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="maxima-verosimilitud.html"><a href="maxima-verosimilitud.html#propiedades-de-los-estimadores-de-maxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-parametrico.html"><a href="bootstrap-parametrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analisis-bayesiano.html"><a href="analisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#calculo-de-la-distribucion-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximacion-por-cuadricula.html"><a href="aproximacion-por-cuadricula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#metropolis"><i class="fa fa-check"></i>Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-caso-general.html"><a href="metropolis-caso-general.html"><i class="fa fa-check"></i>Metrópolis: caso general</a><ul>
<li class="chapter" data-level="" data-path="metropolis-caso-general.html"><a href="metropolis-caso-general.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.6</b> Muestreador de Gibbs</a></li>
<li class="chapter" data-level="10.7" data-path="jags.html"><a href="jags.html"><i class="fa fa-check"></i><b>10.7</b> JAGS</a><ul>
<li class="chapter" data-level="" data-path="jags.html"><a href="jags.html#ejemplo-normal-1"><i class="fa fa-check"></i>Ejemplo normal</a></li>
<li class="chapter" data-level="" data-path="jags.html"><a href="jags.html#diagnosticos"><i class="fa fa-check"></i>Diagnósticos</a></li>
<li class="chapter" data-level="10.7.1" data-path="jags.html"><a href="jags.html#recomendaciones-generales"><i class="fa fa-check"></i><b>10.7.1</b> Recomendaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="10.8.1" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i><b>10.8.1</b> Muestreo HMC</a></li>
<li class="chapter" data-level="10.8.2" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#ejemplo"><i class="fa fa-check"></i><b>10.8.2</b> Ejemplo</a></li>
<li class="chapter" data-level="10.8.3" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#iniciales"><i class="fa fa-check"></i><b>10.8.3</b> Iniciales</a></li>
<li class="chapter" data-level="10.8.4" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#recursos-adicionales-1"><i class="fa fa-check"></i><b>10.8.4</b> Recursos adicionales</a></li>
<li class="chapter" data-level="10.8.5" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#referencias"><i class="fa fa-check"></i><b>10.8.5</b> Referencias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="transformacion-de-datos-1.html"><a href="transformacion-de-datos-1.html"><i class="fa fa-check"></i>2-Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios-1.html"><a href="datos-limpios-1.html"><i class="fa fa-check"></i>3-Datos Limpios</a></li>
<li class="chapter" data-level="" data-path="probabilidad.html"><a href="probabilidad.html"><i class="fa fa-check"></i>4-Probabilidad</a></li>
<li class="chapter" data-level="" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i>5-Bootstrap</a><ul>
<li class="chapter" data-level="" data-path="bootstrap.html"><a href="bootstrap.html#solucion"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cobertura-de-intervalos-de-confianza.html"><a href="cobertura-de-intervalos-de-confianza.html"><i class="fa fa-check"></i>6-Cobertura de intervalos de confianza</a><ul>
<li class="chapter" data-level="" data-path="cobertura-de-intervalos-de-confianza.html"><a href="cobertura-de-intervalos-de-confianza.html#solucion-1"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simulacion-de-modelos-1.html"><a href="simulacion-de-modelos-1.html"><i class="fa fa-check"></i>7-Simulación de modelos</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-modelos-de-regresion.html"><a href="simulacion-de-modelos-de-regresion.html"><i class="fa fa-check"></i>8-Simulación de modelos de regresión</a></li>
<li class="chapter" data-level="" data-path="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><a href="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><i class="fa fa-check"></i>9-Inferencia gráfica, tamaño de muestra, bootstrap paramétrico.</a><ul>
<li class="chapter" data-level="" data-path="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><a href="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html#solucion-2"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>10-Familias conjugadas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias-1.html"><a href="referencias-1.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferencia-visual" class="section level2">
<h2><span class="header-section-number">8.3</span> Inferencia visual</h2>
<p>Las gráficas nos ayudan a descubrir patrones, a diferencia de los modelos las
gráficas nos pueden sorprender y podemos entender relaciones en las variables
que de otra manera sería difícil.</p>
<p>La siguiente gráfica muestra las tasas de mortalidad por diabetes para mayores
de 75 años. Usamos las siguientes fuentes:</p>
<ul>
<li><p>INEGI - <a href="http://www3.inegi.org.mx/rnm/index.php/catalog/231">México estadísticas vitales, defunciones generales y fetales 2015</a>.</p></li>
<li><p>CONAPO - <a href="http://www.conapo.gob.mx/es/CONAPO/Proyecciones_Datos">Estimaciones y proyecciones de la población, datos descargados de CONAPO</a>.</p></li>
</ul>
<p><img src="imagenes/tasas_cancer_1.png" alt="drawing" width="650" class="center-image"/></p>
<div id="apofenia" class="section level4 unnumbered">
<h4>Apofenia</h4>
<p>El <em>ímpetu por concluir</em> (<em>rage-to-conclude bias</em>, Tufte) nos hace ver patrones
en datos donde no existen dichos patrones. Esto puede conllevar a inferencias
prematuras, el análisis estadístico busca alinear la realidad en la evidencia
con la inferencia que se realiza a partir de dicha evidencia.</p>
<p><img src="imagenes/apofenia.png" alt="drawing" width="500px" class="center-image"/></p>
<p>La inferencia visual nos permite descubrir nuevas relaciones, controlando la
apofenia.</p>
<p>¿Qué mapa muestra las tasas de mortalidad reales?</p>
<p><img src="imagenes/tasas_cancer_2.png" />
Si podemos distinguir los datos hay evidencia estadística rigurosa de
un patrón espacial en las tasas de mortalidad que se puede detectar en la
gráfica.</p>
</div>
<div id="inferencia" class="section level3 unnumbered">
<h3>Inferencia</h3>
<p>Recordemos que la inferencia ocurre cuando usamos muestras de los datos para
concluir acerca de la población completa.</p>
<p>Típicamente se usan estadísticas (funciones de la muestra) como medias,
desviaciones estándar, medianas, etc. y nuestros conocimientos de como se
comportan las estadísticas a lo largo de las posibles muestras (ej. error estándar
de la media).</p>
<p>En el caso de inferencia visual <strong>las estadísticas son las gráficas</strong>.</p>
<p>Las referencias de esta sección son los artículos <span class="citation">Hofmann et al. (<a href="#ref-infovis">2010</a>)</span>, <span class="citation">Cook et al. (<a href="#ref-graphical-tests">2012</a>)</span>,
<span class="citation">Buja et al. (<a href="#ref-buja">2009</a>)</span>, la discusión en el sitio de Tufte, E. <a href="http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0003wa">Making better inferences from statistical graphics</a> y
la presentación de Cook, D. <a href="http://www.dicook.org/files/rstudio/#1">To the tidyverse and beyond: Challenges to the future of data science</a>.</p>
</div>
<div id="protocolos-de-inferencia-visual" class="section level3 unnumbered">
<h3>Protocolos de inferencia visual</h3>
<ul>
<li><p><strong>Rorschach</strong>. Antes de observar los datos, grafica una serie de datos nulos,
para obtener una idea de como se vería nuestra gráfica cuando no hay relación
entre las variables.</p></li>
<li><p><strong>Lineup</strong>. Escondemos la gráfica de los datos en un conjunto de datos nulos
y pregunta a un tercero si puede identificar los datos reales. Si eligen la
gráfica con los datos <em>verdaderos</em> tenemos evidencia de que los datos tienen
estructura que es significativamente diferente a lo que esperaríamos por azar.</p></li>
</ul>
<div id="datos-nulos" class="section level4 unnumbered">
<h4>Datos nulos</h4>
<p>Para generar datos nulos podemos usar un método no paramétrico o uno
paramétrico.</p>
<ul>
<li><p><strong>Permutación</strong>: Seleccionamos una de las columnas de los datos de interés
y permutamos los valores.</p></li>
<li><p><strong>Simulación</strong>: Suponemos que una variable sigue una distribución y simulamos
de esta.</p></li>
</ul>
</div>
<div id="calibracion-con-rorschach" class="section level4 unnumbered">
<h4>Calibración con Rorschach</h4>
<p>La siguiente imagen proviene de un escrito de Edmond Murphy que en 1964 escribió
sobre la dudosa inferencia de mecanismos causales a partir de la observación de
una distribución bimodal (<span class="citation">Tufte (<a href="#ref-tufte86">1986</a>)</span>, p. 169):</p>
<p><img src="imagenes/tufte.png" /></p>
</div>
<div id="ejemplo-estaturas" class="section level4 unnumbered">
<h4>Ejemplo: Estaturas</h4>
<p>Estaturas de hombres y mujeres. Supongamos que nos interesa describir de manera
simple los datos, independientemente de si se trata de un hombre o una mujer.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(singer_g)
<span class="co">#&gt; Observations: 235</span>
<span class="co">#&gt; Variables: 2</span>
<span class="co">#&gt; $ gender &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, ...</span>
<span class="co">#&gt; $ height &lt;dbl&gt; 163, 157, 168, 165, 152, 155, 165, 168, 165, 160, 170, ...</span></code></pre>
<ul>
<li>Suponemos que la estatura es una medición que se distribuye aproximadamente
normal con media 171 cm y desviación estándar 10 cm. ¿Es razonable esta
descripción?*</li>
</ul>
<p>Una manera de probar que tan buena es esta descripción es considerando qué es
lo que veríamos si el modelo es el que acabamos de mencionar, para esto
hacemos 19 simulaciones bajo el modelo <span class="math inline">\(N(\mu, \sigma^2)\)</span> y las comparamos con
los datos observados. ¿Captura este modelo las características observadas?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nullabor)

sing_null &lt;-<span class="st"> </span><span class="kw">lineup</span>(<span class="kw">null_dist</span>(<span class="st">&#39;height&#39;</span>, <span class="dt">dist =</span> <span class="st">&#39;normal&#39;</span>, 
    <span class="dt">params =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">171</span>, <span class="dt">sd =</span> <span class="dv">10</span>)), <span class="dt">n =</span> <span class="dv">20</span>, singer_g)
<span class="co">#&gt; decrypt(&quot;A3tW nwmw RI hOGRmROI 00&quot;)</span>

<span class="kw">ggplot</span>(sing_null, <span class="kw">aes</span>(<span class="dt">x =</span> gender, <span class="dt">y =</span> height)) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.sample) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">height =</span> <span class="dv">1</span>), 
        <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Veremos como estas pruebas visuales se comparan con las pruebas de hipótesis
típicas de estadística.</p>
</div>
</div>
<div id="pruebas-de-hipotesis-tipicas" class="section level3 unnumbered">
<h3>Pruebas de hipótesis típicas</h3>
<p>Antes de proseguir recordemos los conceptos de prueba de hipótesis:</p>
<ol style="list-style-type: decimal">
<li><p>Hipótesis nula (<span class="math inline">\(H_0\)</span>): hipótesis que se desea contrastar, describe la
conducta <em>default</em> del fenómeno de interés.</p></li>
<li><p>Hipótesis alternativa (<span class="math inline">\(H_1\)</span>).</p></li>
<li><p>Estadística de prueba: es una estadística con base en la cuál tomamos
la decisión de rechazar o no rechazar. Se calcula considerando la hipótesis
nula como verdadera.</p></li>
<li><p>Valor-p: Nivel de significancia alcanzado, probabilidad de que la estadística
de prueba sea al menos tan extrema como la observada con los datos si la
hipótesis nula es verdadera.</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th>Escenario</th>
<th><span class="math inline">\(H_0\)</span> verdadera</th>
<th><span class="math inline">\(H_0\)</span> Falsa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rechazar <span class="math inline">\(H_0\)</span></td>
<td>Error Tipo 1 (<span class="math inline">\(\alpha\)</span>)</td>
<td>Decisión correcta</td>
</tr>
<tr class="even">
<td>No rechazar <span class="math inline">\(H_0\)</span></td>
<td>Decisión correcta</td>
<td>Error tipo 2 (<span class="math inline">\(\beta\)</span>)</td>
</tr>
</tbody>
</table>
<div id="ejemplo-estaturas-1" class="section level4 unnumbered">
<h4>Ejemplo: estaturas</h4>
<p>Usamos datos de estaturas, la hipótesis nula es que la media de las estaturas
es la misma para hombres y mujeres.
Hipótesis:
<span class="math display">\[H_0:\mu_m = \mu_h\]</span>
Estadistica de prueba es:
<span class="math display">\[Z=\frac{\bar{X_m}-\bar{X_h}}{\hat{\sigma}\sqrt{1/n_1+1/n_2}}\]</span>
la prueba se basa en una distribución <span class="math inline">\(t\)</span> con <span class="math inline">\(n_1 + n_2 - 2\)</span> grados de libertad.</p>
<pre class="sourceCode r"><code class="sourceCode r">heights_f &lt;-<span class="st"> </span>singer_g<span class="op">$</span>height[singer_g<span class="op">$</span>gender <span class="op">==</span><span class="st"> &quot;F&quot;</span>]
heights_m &lt;-<span class="st"> </span>singer_g<span class="op">$</span>height[singer_g<span class="op">$</span>gender <span class="op">==</span><span class="st"> &quot;M&quot;</span>]
n_f &lt;-<span class="st"> </span><span class="kw">length</span>(heights_f)
n_m &lt;-<span class="st"> </span><span class="kw">length</span>(heights_m)
t &lt;-<span class="st"> </span>(<span class="kw">mean</span>(heights_m) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(heights_f)) <span class="op">/</span><span class="st"> </span>(<span class="kw">sd</span>(singer_g<span class="op">$</span>height) <span class="op">*</span><span class="st"> </span>
<span class="st">        </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n_f <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n_m))
t
<span class="co">#&gt; [1] 11.2</span></code></pre>
<p>Y rechazamos si <span class="math inline">\(t\)</span> es menor/mayor al valor crítico <span class="math inline">\(t^*\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">t_star &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.025</span>, n_f <span class="op">+</span><span class="st"> </span>n_m <span class="dv">-2</span>)
t_star
<span class="co">#&gt; [1] -1.97</span></code></pre>
<p><strong>Datos nulos:</strong> ¿Cómo se ven los <em>inocentes</em>?</p>
<pre class="sourceCode r"><code class="sourceCode r">nulos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t =</span> <span class="kw">rt</span>(<span class="dv">10000</span>, <span class="dv">233</span>))
<span class="kw">ggplot</span>(nulos, <span class="kw">aes</span>(<span class="dt">x =</span> t)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(t_star, <span class="op">-</span>t_star), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, 
        <span class="dt">alpha =</span> <span class="fl">0.5</span>) 
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-29-1.png" width="300px" /></p>
<p>Notamos que el valor obtenido con nuestros datos está en las colas de la
distribución, es decir, es muy poco plausible observar un valor tan bajo como
el que obtenemos bajo la hipótesis nula. ¿Cómo calculamos el valor-p con
simulación?</p>
</div>
</div>
<div id="inferencia-visual-1" class="section level3 unnumbered">
<h3>Inferencia visual</h3>
<p>Los principios de pruebas de hipótesis son los mismos para pruebas visuales,
a excepción de dos aspectos: la estadística de prueba y el mecanismo para
medir similitud.</p>
<p><strong>La estadística de prueba ahora es una gráfica de los datos,
y en lugar de una diferencia matemática usamos el ojo humano.</strong></p>
<p>En la siguiente prueba gráfica, los verdaderos datos están escondidos entre 19 gráficas
de datos nulos, donde un dato nulo es una muestra de la distribución bajo la
hipótesis nula. Si es posible identificar los datos, hay evidencia indicando
que estos son distintos a los datos nulos.</p>
<div class="caja">
<p>Prueba visual
1. Genera n-1 datos nulos (datos que siguen la hipótesis nula)</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Grafica los nulos + los datos reales, donde los datos están posicionados
de manera aleatoria.</p></li>
<li><p>Muestra la gráfica a un observador imparcial.</p></li>
</ol>
<p>¿Pueden distinguir los datos? Si es el caso, hay evidencia de diferencia
verdadera (valor p = 1/n).</p>
</div>
<div id="regresando-a-estaturas" class="section level4 unnumbered">
<h4>Regresando a estaturas</h4>
<p>Volvamos al ejemplo de las estaturas, proponemos el siguiente modelo: la
estatura es aproximadamente normal con media 179 para hombres y 164 para mujeres,
la desviación estándar es de 6.5 en ambos casos.</p>
<pre class="sourceCode r"><code class="sourceCode r">singer_g <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">mean</span>(height), <span class="kw">sd</span>(height))
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   gender `mean(height)` `sd(height)`</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt; 1 F                164.         6.33</span>
<span class="co">#&gt; 2 M                179.         6.92</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nullabor)
singer_c &lt;-<span class="st"> </span>singer_g <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">height_c =</span> height <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(height))
<span class="kw">set.seed</span>(<span class="dv">26832</span>)
sing_null_c &lt;-<span class="st"> </span><span class="kw">lineup</span>(<span class="kw">null_dist</span>(<span class="st">&#39;height_c&#39;</span>, <span class="dt">dist =</span> <span class="st">&#39;normal&#39;</span>, 
    <span class="dt">params =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="kw">sd</span>(singer_c<span class="op">$</span>height_c))), <span class="dt">n =</span> <span class="dv">20</span>, singer_c)
<span class="co">#&gt; decrypt(&quot;A3tW nwmw RI hOGRmROI 0Y&quot;)</span>
<span class="kw">head</span>(sing_null_c)
<span class="co">#&gt;   gender height height_c .sample</span>
<span class="co">#&gt; 1      F    163   -2.579       1</span>
<span class="co">#&gt; 2      F    157    1.151       1</span>
<span class="co">#&gt; 3      F    168    3.589       1</span>
<span class="co">#&gt; 4      F    165    0.496       1</span>
<span class="co">#&gt; 5      F    152    8.716       1</span>
<span class="co">#&gt; 6      F    155  -16.618       1</span></code></pre>
<p>Prueba:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(sing_null_c, <span class="kw">aes</span>(<span class="dt">x =</span> gender, <span class="dt">y =</span> height_c)) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.sample) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">height =</span> <span class="dv">1</span>), 
        <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>En esta segunda prueba gráfica no rechazamos la hipótesis nula.</p>
</div>
<div id="porque-pruebas-visuales" class="section level4 unnumbered">
<h4>¿Porqué pruebas visuales?</h4>
<p>En el ejemplo de estaturas se pueden utilizar pruebas estadísticas tradicionales,
sin embargo, estas pruebas no cubren todas las complejidades que pueden surgir
en una exploración de datos.</p>
<p>El siguiente es un <em>lineup</em> de nubes de palabras tomado de <a href="http://stat.wharton.upenn.edu/~buja/PAPERS/Wickham-Cook-Hofmann-Buja-IEEE-TransVizCompGraphics_2010-Graphical%20Inference%20for%20Infovis.pdf">Graphical Inference for Infovis</a>.</p>
<p><img src="imagenes/wordcloud.png" /></p>
<p>Además, las pruebas visuales nos pueden enseñar no solo si rechazamos la
hipótesis nula, sino que en ocasiones revelan el por qué rechazar.</p>
</div>
<div id="el-paquete-nullabor" class="section level4 unnumbered">
<h4>El paquete nullabor</h4>
<p>El paquete <code>nullabor</code> tiene funciones para implementar los protocolos
<em>Rorschach</em> y <em>Lineup</em>, en cualquiera de los dos protocolos el primer paso es
poder generar datos nulos, y para ello <code>nullabor</code> incluye las siguientes
opciones:</p>
<p><code>null_permute</code>: Utiliza permutación, la variable es independiente de las otras.</p>
<p><code>null_dist</code>: Simula dada una distribución particular: Beta, Cauchy, Exponencial,
Poisson,…</p>
<p><code>null_lm</code>: Simula cuando la variable es una combinación lineal de predictores.</p>
<p>Hay ocasiones que queremos simular datos nulos más allá de las funciones
incluídas en <code>nullabor</code>, más adelante veremos un ejemplo de <span class="citation">Gelman and Hill (<a href="#ref-gelman-hill">2007</a>)</span> donde
utilizamos lo aprendido en la sección de simulación de modelos para implementar
nuestra prueba visual. Adicionalmente, el <a href="http://stat.wharton.upenn.edu/~buja/PAPERS/06-Buja-Cook-Hofmann-Lawrence-Lee-Swayne-Wickham-suppl.pdf">material suplemental</a> de <span class="citation">Buja et al. (<a href="#ref-buja">2009</a>)</span> explica
algunas consideraciones para generar datos nulos.</p>
</div>
<div id="ejemplo-diagramas-de-dispersion" class="section level4 unnumbered">
<h4>Ejemplo: diagramas de dispersión</h4>
<p>Un diagrama de dispersión muestra la relación entre dos variables continuas
y responde a la pregunta: ¿existe una relación entre <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span>? Una posible
hipótesis nula es que no hay relación entre las variables. Supongamos que
queremos usar preubas visuales para esta hipótesis, la función <em>null_permute</em>
del paquete nullabor recibe el nombre de una variable de los datos y la salida
de la funcción consiste en la variable permutada para obtener los datos nulos.</p>
<p><img src="imagenes/manicule2.jpg" /> En este ejercicio usarás los datos <code>diamonds</code>,
toma una muestra de tamaño 5000 (sin reemplazo) y procede como se indica:</p>
<ul>
<li><p>Usa la función null_permute para crear una nueva base de datos con la variable
depth permutada en los datos nulos.</p></li>
<li><p>Usa la función line_up (como se usó en el caso de las estaturas) y genera
una gráfica con 20 páneles, donde grafiques depth en el eje horizontal y carat
en el eje vertical tienes evidencia para afirmar que existe una
relación entre depth y carat.</p></li>
<li><p>Explora ahora precio y carat.</p></li>
</ul>
</div>
</div>
<div id="mas-alla-que-permutacion" class="section level3 unnumbered">
<h3>Más allá que permutación</h3>
<p>En muchos casos el supuesto de independencia es demasiado fuerte, es claro que
las variables están relacionadas y queremos estudiar una relación particular.
Por ejemplo, podemos pensar que los intentos de encestar a tres puntos en el
basquetbol siguen una distribución cuadrática en el espacio: mientras el ángulo
entre el jugador y la canasta aumenta el jugador se acerca más para asegurar el
éxito. La siguiente figura prueba esta hipótesis usando datos de los tres
punteros de los Lakers en la temporada 2008/2009, los datos se obtuvieron de
<a href="http://www.basketballgeek.com/data/">Basketball Geek</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">paths &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;data/2008-2009&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;LAL&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)

basket &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">set_names</span>(paths, paths) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">map_df</span>(read_csv)

basket_LA &lt;-<span class="st"> </span>basket <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(team <span class="op">==</span><span class="st"> &quot;LAL&quot;</span>, type <span class="op">==</span><span class="st"> &quot;3pt&quot;</span>, <span class="op">!</span><span class="kw">is.na</span>(x), <span class="op">!</span><span class="kw">is.na</span>(y)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># datos Lakers</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">x =</span> x <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(<span class="kw">length</span>(x), <span class="fl">-0.5</span>, <span class="fl">0.5</span>),
    <span class="dt">y =</span> y <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(<span class="kw">length</span>(y), <span class="fl">-0.5</span>, <span class="fl">0.5</span>),
    <span class="dt">r =</span> <span class="kw">sqrt</span>((x <span class="op">-</span><span class="st"> </span><span class="dv">25</span>) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y <span class="op">^</span><span class="st"> </span><span class="dv">2</span>),  <span class="co"># distancia a canasta</span>
    <span class="dt">angle =</span> <span class="kw">atan2</span>(y, x <span class="op">-</span><span class="st"> </span><span class="dv">25</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># ángulo</span>
<span class="st">  </span><span class="kw">filter</span>(r <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span> <span class="op">&amp;</span><span class="st"> </span>r <span class="op">&lt;</span><span class="st"> </span><span class="dv">39</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># lanzamientos en el rango típico</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(x, y, r, angle)

<span class="co"># guardar datos</span>
<span class="kw">write.table</span>(basket_LA, <span class="dt">file =</span> <span class="st">&quot;data/basket_LA.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(basket_LA)
<span class="co">#&gt; Observations: 1,410</span>
<span class="co">#&gt; Variables: 4</span>
<span class="co">#&gt; $ x     &lt;dbl&gt; 1.137, 41.175, 45.635, 37.477, 43.171, 7.752, 15.801, 0....</span>
<span class="co">#&gt; $ y     &lt;dbl&gt; 5.96, 26.14, 17.24, 30.15, 24.28, 27.82, 28.73, 5.39, 29...</span>
<span class="co">#&gt; $ r     &lt;dbl&gt; 24.6, 30.7, 26.9, 32.6, 30.3, 32.7, 30.2, 24.6, 33.6, 32...</span>
<span class="co">#&gt; $ angle &lt;dbl&gt; 2.897, 1.017, 0.696, 1.178, 0.928, 2.126, 1.881, 2.921, ...</span>

basket_null &lt;-<span class="st"> </span><span class="kw">lineup</span>(<span class="kw">null_lm</span>(r <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(angle, <span class="dv">2</span>)), basket_LA, <span class="dt">n =</span> <span class="dv">10</span>)
<span class="co">#&gt; decrypt(&quot;A3tW nwmw RI hOGRmROI 01&quot;)</span>

<span class="kw">ggplot</span>(basket_null, <span class="kw">aes</span>(<span class="dt">x =</span> angle <span class="op">*</span><span class="st"> </span><span class="dv">180</span> <span class="op">/</span><span class="st"> </span>pi, <span class="dt">y =</span> r)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;Angle (degrees)&quot;</span>, 
        <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="dv">90</span>, <span class="dv">135</span>, <span class="dv">180</span>), 
    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">180</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.sample, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-34-1.png" width="768" /></p>
<p>Los datos reales están <em>escondidos</em> entre un conjunto de datos nulos que siguen
la hipótesis de una relación cuadrática, los conjuntos nulos se crean ajustando
el modelo, produciendo predicciones y residuales, y sumando los residuales
rotados a las predicciones.</p>
<p>En el siguiente ejemplo buscamos usar el protocolo <em>lineup</em> para evauar
el ajuste de un modelo, en este caso no usaremos el paquete <code>nullabor</code> sino que
simularemos directamente del modelo.</p>
<div id="ejemplo-modelo-poisson-con-sobreabundancia-de-ceros" class="section level4 unnumbered">
<h4>Ejemplo: modelo Poisson con sobreabundancia de ceros</h4>
<p>Las ideas detrás de inferencia visual para diagnósticos de modelos son comunes
en estadística bayesiana, y se pueden extender a la estimación frecuentista
usando lo que aprendimos en la sección de simulación de modelos probabilísticos.</p>
<p>Cuando simulamos datos usando el modelo se conoce como simulación de
<em>datos falsos</em> (<em>fake data</em>) o datos replicados y lo que buscamos es comparar
datos simulados bajo el modelo ajustado con los datos observados. El siguiente
ejemplo se tomó de <span class="citation">Gelman and Hill (<a href="#ref-gelman-hill">2007</a>)</span>.</p>
<p>Problema: se busca estudiar el efecto de pesticidas en el control de cucarachas
en departamentos urbanos. Se realiza un experimento donde se dividen los
departamentos en:</p>
<ul>
<li>grupo de tratamiento (<span class="math inline">\(160\)</span> deptos.) y</li>
<li>grupo de control (<span class="math inline">\(104\)</span> deptos.).</li>
</ul>
<p>En cada departamento se mide el número de cucarachas atrapadas <span class="math inline">\(y_i\)</span> en un
conjunto de trampas. Distintos departamentos tuvieron trampas un
número distinto de días, y denotamos por <span class="math inline">\(u_i\)</span> el número de días-trampa en el
i-ésimo departamento. Se propone el siguiente modelo:</p>
<p><span class="math display">\[y_i \sim Poisson(u_iexp(X\beta))\]</span></p>
<p>donde X reprersenta variables explicativas (predictores), en este caso,
consisten en el nivel de cucarachas antes del tratamiento (roach1), una variable
binaria indicando si se aplica insecticida en el departamento (treatment) y una
variable binaria indicando si el edificio es de personas mayor (senior). En R el
modelo se ajusta como sigue:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(arm)
roachdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/roachdata.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
glm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>roach1 <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>senior, <span class="dt">family =</span> poisson, 
  <span class="dt">offset =</span> <span class="kw">log</span>(exposure2), <span class="dt">data =</span> roachdata)
<span class="kw">display</span>(glm_<span class="dv">1</span>)
<span class="co">#&gt; glm(formula = y ~ roach1 + treatment + senior, family = poisson, </span>
<span class="co">#&gt;     data = roachdata, offset = log(exposure2))</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept)  3.09     0.02  </span>
<span class="co">#&gt; roach1       0.01     0.00  </span>
<span class="co">#&gt; treatment   -0.52     0.02  </span>
<span class="co">#&gt; senior      -0.38     0.03  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;   n = 262, k = 4</span>
<span class="co">#&gt;   residual deviance = 11429.5, null deviance = 16953.7 (difference = 5524.2)</span></code></pre>
<p>¿Qué tan bien se ajusta el modelo a los datos? Para responder esta pregunta
simularemos del modelo.</p>
<pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>roach1 <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>senior, <span class="dt">family =</span> poisson, 
  <span class="dt">data =</span> roachdata)
n &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)
simula_modelo &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n_sims =</span> <span class="dv">19</span>, ajuste){
    <span class="co"># simulamos los coeficientes del modelo</span>
    betas &lt;-<span class="st"> </span><span class="kw">coef</span>(<span class="kw">sim</span>(ajuste, n_sims))
    <span class="co"># calculamos ui*exp(Xb)</span>
    y_hat &lt;-<span class="st"> </span>roachdata<span class="op">$</span>exposure2 <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(X <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(betas))
    <span class="co"># creamos una lista con las y_hat de cada simulación</span>
    y_hat_list &lt;-<span class="st"> </span><span class="kw">split</span>(y_hat, <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(y_hat), <span class="dt">each =</span> <span class="kw">nrow</span>(y_hat)))
    <span class="co"># simulamos observaciones</span>
    y_sims &lt;-<span class="st"> </span><span class="kw">map_df</span>(y_hat_list, <span class="op">~</span><span class="kw">rpois</span>(n, .))
    y_sims_df &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(<span class="dt">X =</span> <span class="dv">1</span><span class="op">:</span>n, y_sims) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">gather</span>(sim, y, <span class="op">-</span>X) 
    <span class="co"># código para esconder los datos</span>
    codigo &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n_sims <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), n_sims <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)
    sims_datos &lt;-<span class="st"> </span>y_sims_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">bind_rows</span>(dplyr<span class="op">::</span><span class="kw">select</span>(roachdata, X, y)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">sample =</span> <span class="kw">rep</span>(codigo, <span class="dt">each =</span> n))
    <span class="kw">list</span>(<span class="dt">sims_datos =</span> sims_datos, <span class="dt">y_sims_df =</span> y_sims_df,
        <span class="dt">codigo =</span> codigo[n_sims <span class="op">+</span><span class="st"> </span><span class="dv">1</span>])
}

sim_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">simula_modelo</span>(<span class="dt">n_sims =</span> <span class="dv">9</span>, glm_<span class="dv">1</span>)
<span class="kw">ggplot</span>(sim_<span class="dv">1</span><span class="op">$</span>sims_datos, <span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">40</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>sample, <span class="dt">nrow =</span> <span class="dv">2</span>)
<span class="co">#&gt; Warning: Removed 311 rows containing non-finite values (stat_bin).</span>
<span class="co">#&gt; Warning: Removed 20 rows containing missing values (geom_bar).</span></code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-36-1.png" width="576" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># los datos están en sim_1$codigo</span></code></pre>
<ul>
<li>¿En que se diferencían los datos observados de los simulados?</li>
</ul>
<p>Comparemos el número de ceros de los datos observados y el primer conjunto de
datos simulados:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(roachdata<span class="op">$</span>y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
<span class="co">#&gt; [1] 0.359</span>
<span class="kw">mean</span>(sim_<span class="dv">1</span><span class="op">$</span>sims_datos<span class="op">$</span>y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
<span class="co">#&gt; [1] 0.037</span></code></pre>
<p>Vemos que el <span class="math inline">\(36\%\)</span> de los datos observados hay ceros mientras que en los
datos replicados el porcentaje de ceros es cercano a cero.</p>
<p>Además de la prueba visual podemos pensar en la proporción de ceros como una
estadística de prueba, simulamos <span class="math inline">\(1000\)</span> conjuntos de datos y calculamos la
proporción de ceros:</p>
<pre class="sourceCode r"><code class="sourceCode r">sim_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">simula_modelo</span>(<span class="dv">1000</span>, glm_<span class="dv">1</span>)
<span class="co"># calculamos el porcentaje de ceros en cada conjunto simulado</span>
sims_p_ceros &lt;-<span class="st"> </span>sim_<span class="dv">2</span><span class="op">$</span>y_sims_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">p_ceros =</span> <span class="kw">mean</span>(y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))
<span class="kw">min</span>(sims_p_ceros<span class="op">$</span>p_ceros)
<span class="co">#&gt; [1] 0</span>
<span class="kw">max</span>(sims_p_ceros<span class="op">$</span>p_ceros)
<span class="co">#&gt; [1] 0.00763</span></code></pre>
<p>Vemos que en el porcentaje de ceros varía entre <span class="math inline">\(0\)</span> y <span class="math inline">\(0.008\)</span>, todos ellos
mucho menores a la estadística de prueba <span class="math inline">\(0.36\)</span>.</p>
<p>Ahora veamos que ocurre si ajustamos un modelo Poisson con sobredispersión, este
modelo busca acomodar la sobreabundancia de ceros observada en los datos y que
no es congruente con el modelo Poisson que ajustamos.</p>
<pre class="sourceCode r"><code class="sourceCode r">glm_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>roach1 <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>senior, <span class="dt">family =</span> quasipoisson, 
  <span class="dt">offset =</span> <span class="kw">log</span>(exposure2), <span class="dt">data =</span> roachdata)
<span class="kw">display</span>(glm_<span class="dv">2</span>)
<span class="co">#&gt; glm(formula = y ~ roach1 + treatment + senior, family = quasipoisson, </span>
<span class="co">#&gt;     data = roachdata, offset = log(exposure2))</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept)  3.09     0.17  </span>
<span class="co">#&gt; roach1       0.01     0.00  </span>
<span class="co">#&gt; treatment   -0.52     0.20  </span>
<span class="co">#&gt; senior      -0.38     0.27  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;   n = 262, k = 4</span>
<span class="co">#&gt;   residual deviance = 11429.5, null deviance = 16953.7 (difference = 5524.2)</span>
<span class="co">#&gt;   overdispersion parameter = 65.4</span>

simula_modelo &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n_sims =</span> <span class="dv">19</span>, ajuste){
    <span class="co"># simulamos los coeficientes del modelo</span>
    betas &lt;-<span class="st"> </span><span class="kw">coef</span>(<span class="kw">sim</span>(ajuste, n_sims))
    <span class="co"># calculamos ui*exp(Xb)</span>
    y_hat &lt;-<span class="st"> </span>roachdata<span class="op">$</span>exposure2 <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(X <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(betas))
    <span class="co"># creamos una lista con las y_hat de cada simulación</span>
    y_hat_list &lt;-<span class="st"> </span><span class="kw">split</span>(y_hat, <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(y_hat), <span class="dt">each =</span> <span class="kw">nrow</span>(y_hat)))
    <span class="co"># simulamos observaciones</span>
    y_sims &lt;-<span class="st"> </span><span class="kw">map_df</span>(y_hat_list, <span class="op">~</span><span class="kw">rnegbin</span>(n, ., . <span class="op">/</span><span class="st"> </span>(<span class="fl">65.4</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)))
    y_sims_df &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(<span class="dt">X =</span> <span class="dv">1</span><span class="op">:</span>n, y_sims) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">gather</span>(sim, y, <span class="op">-</span>X) 
    <span class="co"># código para esconder los datos</span>
    codigo &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n_sims <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), n_sims <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)
    sims_datos &lt;-<span class="st"> </span>y_sims_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">bind_rows</span>(dplyr<span class="op">::</span><span class="kw">select</span>(roachdata, X, y)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">sample =</span> <span class="kw">rep</span>(codigo, <span class="dt">each =</span> n))
    <span class="kw">list</span>(<span class="dt">sims_datos =</span> sims_datos, <span class="dt">y_sims_df =</span> y_sims_df, <span class="dt">codigo =</span> codigo[n_sims <span class="op">+</span><span class="st"> </span><span class="dv">1</span>])
}

sim_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">simula_modelo</span>(<span class="dt">n_sims =</span> <span class="dv">9</span>, glm_<span class="dv">2</span>)
<span class="kw">ggplot</span>(sim_<span class="dv">2</span><span class="op">$</span>sims_datos, <span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>sample, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-39-1.png" width="576" /></p>
<p>El panel que corresponde a los datos es:</p>
<pre class="sourceCode r"><code class="sourceCode r">sim_<span class="dv">2</span><span class="op">$</span>codigo
<span class="co">#&gt; [1] 1</span></code></pre>
<p>Podemos comparar el número de ceros.</p>
<pre class="sourceCode r"><code class="sourceCode r">sim_<span class="dv">1000</span> &lt;-<span class="st"> </span><span class="kw">simula_modelo</span>(<span class="dv">1000</span>, glm_<span class="dv">2</span>)
<span class="co"># calculamos el porcentaje de ceros en cada conjunto simulado</span>
sims_p_ceros &lt;-<span class="st"> </span>sim_<span class="dv">1000</span><span class="op">$</span>y_sims_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">p_ceros =</span> <span class="kw">mean</span>(y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))
<span class="kw">mean</span>(sims_p_ceros<span class="op">$</span>p_ceros <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.36</span>)
<span class="co">#&gt; [1] 0.18</span></code></pre>
<p>En este caso el <span class="math inline">\(19\%\)</span> de los datos muestran una proporción de ceros al menos
tan alta como la observada.</p>
<p>La simulación de datos <em>falsos</em> no debe ser la única herramienta para evaluar
el ajuste de un modelo; sin embargo, es una herramienta útil que nos puede
ayudar a detectar desajustes y en caso de revelarlos nos da indicios de porque
falla el modelo.</p>
</div>
</div>
<div id="otras-consideraciones-1" class="section level3 unnumbered">
<h3>Otras consideraciones</h3>
<p><strong>Potencia</strong></p>
<ul>
<li><p>La potencia en una prueba de hipótesis es la probabilidad de rechazar la
hipótesis nula cuando esta es falsa.</p></li>
<li><p>En el caso de pruebas visuales la potencia depende de la calidad de la
gráfica.</p></li>
<li><p>Se ha estudiado la potencia de las pruebas visuales, <span class="citation">Majumder, Hofmann, and Cook (<a href="#ref-majumder">2013</a>)</span> y se ha visto
con simulación que las pruebas visuales pueden tener potencia comparable a las
pruebas de hipótesis tradicionales, a veces incluso superándolas.</p></li>
<li><p>El paquete <code>nullabor</code> incluye la función <code>visual_power()</code> para calcular
el poder de una prueba simulada.</p></li>
</ul>
<p><strong>Valor p</strong></p>
<ul>
<li><p>Si usamos un jurado compuesto por <span class="math inline">\(K\)</span> jueces en lugar de un juez y <span class="math inline">\(k\)</span> de
ellos entonces el valor p combinado es <span class="math inline">\(P(X \le k)\)</span> donde <span class="math inline">\(X\)</span> tiene distribución
<span class="math inline">\(Binomial(K, 1/20)\)</span>. Si todos los jueces identifican los datos el valor p sería
<span class="math inline">\(0.05^K\)</span></p></li>
<li><p>El paquete <code>nullabor</code> tiene una función para calcular el valor p de una
prueba dada <code>pvisual()</code>.</p></li>
</ul>
<p>Las pruebas de hipótesis visuales, no son la única herramienta que se debe usar
en el análisis exploratorio o para evaluar un modelo. Sin embargo, las pruebas
visuales nos ayudan a explorar relaciones observadas en gráficas controlando por
la apofenia, y en general graficar modelos ajustados nos puede ayudar
a comprender las implicaciones de un modelo y las fallas del mismo.</p>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-infovis">
<p>Hofmann, H., H. Wickham, D. Cook, and A. Buja. 2010. “Graphical Inference for Infovis.” <em>IEEE Transactions on Visualization &amp; Computer Graphics</em> 16 (September):973–79. <a href="https://doi.org/10.1109/TVCG.2010.161" class="uri">https://doi.org/10.1109/TVCG.2010.161</a>.</p>
</div>
<div id="ref-graphical-tests">
<p>Cook, D., M. Majumder, L. Follett, and H. Hofmann. 2012. “Graphical Tests for Power Comparison of Competing Designs.” <em>IEEE Transactions on Visualization &amp; Computer Graphics</em> 18 (December):2441–8. <a href="https://doi.org/10.1109/TVCG.2012.230" class="uri">https://doi.org/10.1109/TVCG.2012.230</a>.</p>
</div>
<div id="ref-buja">
<p>Buja, Andreas, Dianne Cook, Heike Hofmann, Michael Lawrence, Eun-Kyung Lee, Deborah F. Swayne, and Hadley Wickham. 2009. “Statistical Inference for Exploratory Data Analysis and Model Diagnostics.” <em>Philosophical Transactions of the Royal Society of London A: Mathematical, Physical and Engineering Sciences</em> 367 (1906). The Royal Society:4361–83. <a href="https://doi.org/10.1098/rsta.2009.0120" class="uri">https://doi.org/10.1098/rsta.2009.0120</a>.</p>
</div>
<div id="ref-tufte86">
<p>Tufte, Edward R. 1986. <em>The Visual Display of Quantitative Information</em>. Cheshire, CT, USA: Graphics Press.</p>
</div>
<div id="ref-gelman-hill">
<p>Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Vol. Analytical methods for social research. New York: Cambridge University Press.</p>
</div>
<div id="ref-majumder">
<p>Majumder, Mahbubul, Heike Hofmann, and Dianne Cook. 2013. “Validation of Visual Statistical Inference, Applied to Linear Models.” <em>Journal of the American Statistical Association</em> 108 (503). Taylor &amp; Francis:942–56. <a href="https://doi.org/10.1080/01621459.2013.808157" class="uri">https://doi.org/10.1080/01621459.2013.808157</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-graficos-y-simulacion-predictiva.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2018/edit/master/07-simulacion_modelos.Rmd",
"text": "Edit"
},
"download": ["est-computacional-2018.pdf", "est-computacional-2018.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
