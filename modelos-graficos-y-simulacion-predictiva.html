<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018." />
  <meta name="github-repo" content="tereom/est-computacional-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018." />
  

<meta name="author" content="María Teresa Ortiz">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="distribuciones-multivariadas.html">
<link rel="next" href="inferencia-visual.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.5/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.5/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.5/profvis.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificacion"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduccion-a-visualizacion.html"><a href="introduccion-a-visualizacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a visualización</a><ul>
<li class="chapter" data-level="" data-path="introduccion-a-visualizacion.html"><a href="introduccion-a-visualizacion.html#el-cuarteto-de-ascombe"><i class="fa fa-check"></i>El cuarteto de Ascombe</a></li>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-de-datos-en-la-estadistica"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#principios-generales-del-diseno-analitico"><i class="fa fa-check"></i>Principios generales del diseño analítico</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#tecnicas-de-visualizacion"><i class="fa fa-check"></i>Técnicas de visualización</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#indicadores-de-calidad-grafica"><i class="fa fa-check"></i>Indicadores de calidad gráfica</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#factor-de-engano-chartjunk-y-pies"><i class="fa fa-check"></i>Factor de engaño, chartjunk y pies</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#series-de-tiempo-y-promedio-de-45"><i class="fa fa-check"></i>Series de tiempo y promedio de 45</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#pequenos-multiplos-y-densidad-grafica"><i class="fa fa-check"></i>Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#tinta-de-datos"><i class="fa fa-check"></i>Tinta de datos</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#percepcion-de-escala"><i class="fa fa-check"></i>Percepción de escala</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#minard"><i class="fa fa-check"></i>Minard</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion-a-r-y-al-paquete-ggplot2.html"><a href="introduccion-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-analisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-agrupacion-de-datos.html"><a href="manipulacion-y-agrupacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li><a href="transformacion-de-datos.html#separa-aplica-combina-split-apply-combine">Separa-aplica-combina (<em>split-apply-combine</em>)</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ejemplos-y-lectura-de-datos"><i class="fa fa-check"></i>Ejemplos y lectura de datos</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#summarise-y-resumenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#operador-pipeline"><i class="fa fa-check"></i>Operador pipeline</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-mas-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#mas-de-un-tipo-de-observacion-en-una-misma-tabla"><i class="fa fa-check"></i>Mas de un tipo de observación en una misma tabla</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-esta-almacenada-en-multiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones.html"><a href="funciones.html"><i class="fa fa-check"></i><b>4.1</b> Funciones</a><ul>
<li class="chapter" data-level="" data-path="funciones.html"><a href="funciones.html#estructura-de-una-funcion"><i class="fa fa-check"></i>Estructura de una función</a></li>
<li class="chapter" data-level="" data-path="funciones.html"><a href="funciones.html#observaciones-del-uso-de-funciones"><i class="fa fa-check"></i>Observaciones del uso de funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteracion.html"><a href="iteracion.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeno"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduccion-a-probabilidad.html"><a href="introduccion-a-probabilidad.html"><i class="fa fa-check"></i><b>5</b> Introducción a probabilidad</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extension-a-proporcion.html"><a href="probabilidad-como-extension-a-proporcion.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión a proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretacion-frecuentista-de-probabilidad.html"><a href="interpretacion-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a></li>
<li class="chapter" data-level="5.3" data-path="simulacion-para-el-calculo-de-probabilidades.html"><a href="simulacion-para-el-calculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html"><i class="fa fa-check"></i><b>5.4</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="5.4.1" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html#propiedades-de-la-funcion-de-probabilidad"><i class="fa fa-check"></i><b>5.4.1</b> Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.5</b> Variables aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-parametrico.html"><a href="bootstrap-no-parametrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#funcion-de-distribucion-empirica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parametros-y-estadisticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estandar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#variacion-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#mas-alla-de-muestras-aleatorias-simples"><i class="fa fa-check"></i>Más alla de muestras aleatorias simples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.4</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.5" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.5</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoria-basica-de-simulacion.html"><a href="teoria-basica-de-simulacion.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#aceptacion-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#variables-aleatorias-continuas-1"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#aceptacion-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-modelos.html"><a href="simulacion-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulacion-de-modelos.html"><a href="simulacion-de-modelos.html#para-que-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-graficos-y-simulacion-predictiva.html"><a href="modelos-graficos-y-simulacion-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipotesis-tipicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#mas-alla-que-permutacion"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html"><a href="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html"><i class="fa fa-check"></i><b>8.4</b> Simulación para cálculo de tamaño de muestra/poder estadístico</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-parametrica.html"><a href="inferencia-parametrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="maxima-verosimilitud.html"><a href="maxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="maxima-verosimilitud.html"><a href="maxima-verosimilitud.html#propiedades-de-los-estimadores-de-maxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-parametrico.html"><a href="bootstrap-parametrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analisis-bayesiano.html"><a href="analisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#calculo-de-la-distribucion-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximacion-por-cuadricula.html"><a href="aproximacion-por-cuadricula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introduccion-metropolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metropolis.html"><a href="metropolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metropolis.html"><a href="metropolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metropolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="jags.html"><a href="jags.html"><i class="fa fa-check"></i><b>10.8</b> JAGS</a><ul>
<li class="chapter" data-level="" data-path="jags.html"><a href="jags.html#ejemplo-normal-1"><i class="fa fa-check"></i>Ejemplo normal</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnosticos.html"><a href="diagnosticos.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos</a><ul>
<li class="chapter" data-level="" data-path="diagnosticos.html"><a href="diagnosticos.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.10</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#iniciales"><i class="fa fa-check"></i>Iniciales</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#recursos-adicionales-de-stan"><i class="fa fa-check"></i>Recursos adicionales de Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html"><i class="fa fa-check"></i><b>10.11</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#modelo-jerarquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#multiples-monedas-de-una-misma-fabrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#ejemplo-estimacion-de-tasas-de-mortalidad"><i class="fa fa-check"></i>Ejemplo: estimación de tasas de mortalidad</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#ejemplo-conteo-rapido"><i class="fa fa-check"></i>Ejemplo: conteo rápido</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="flujo-de-trabajo-para-el-analisis-bayesiano.html"><a href="flujo-de-trabajo-para-el-analisis-bayesiano.html"><i class="fa fa-check"></i><b>10.12</b> Flujo de trabajo para el análisis bayesiano</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="transformacion-de-datos-1.html"><a href="transformacion-de-datos-1.html"><i class="fa fa-check"></i>2-Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios-1.html"><a href="datos-limpios-1.html"><i class="fa fa-check"></i>3-Datos Limpios</a></li>
<li class="chapter" data-level="" data-path="probabilidad.html"><a href="probabilidad.html"><i class="fa fa-check"></i>4-Probabilidad</a></li>
<li class="chapter" data-level="" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i>5-Bootstrap</a><ul>
<li class="chapter" data-level="" data-path="bootstrap.html"><a href="bootstrap.html#solucion"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cobertura-de-intervalos-de-confianza.html"><a href="cobertura-de-intervalos-de-confianza.html"><i class="fa fa-check"></i>6-Cobertura de intervalos de confianza</a><ul>
<li class="chapter" data-level="" data-path="cobertura-de-intervalos-de-confianza.html"><a href="cobertura-de-intervalos-de-confianza.html#solucion-1"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simulacion-de-modelos-1.html"><a href="simulacion-de-modelos-1.html"><i class="fa fa-check"></i>7-Simulación de modelos</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-modelos-de-regresion.html"><a href="simulacion-de-modelos-de-regresion.html"><i class="fa fa-check"></i>8-Simulación de modelos de regresión</a></li>
<li class="chapter" data-level="" data-path="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><a href="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><i class="fa fa-check"></i>9-Inferencia gráfica, tamaño de muestra, bootstrap paramétrico.</a><ul>
<li class="chapter" data-level="" data-path="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><a href="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html#solucion-2"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>10-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-2.html"><a href="metropolis-2.html"><i class="fa fa-check"></i>11-Metropolis</a><ul>
<li class="chapter" data-level="" data-path="metropolis-2.html"><a href="metropolis-2.html#solucion-3"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mcmc-convergencia.html"><a href="mcmc-convergencia.html"><i class="fa fa-check"></i>12-MCMC convergencia</a></li>
<li class="chapter" data-level="10.13" data-path="modelos-jerarquicos-1.html"><a href="modelos-jerarquicos-1.html"><i class="fa fa-check"></i><b>10.13</b> 13-Modelos jerárquicos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-graficos-y-simulacion-predictiva" class="section level2">
<h2><span class="header-section-number">8.2</span> Modelos gráficos y simulación predictiva</h2>
<p>El objetivo de esta sección es la simulación de modelos, una manera conveniente
de simular de un modelo probabilístico es a partir del modelo gráfico
asociado. Un modelo gráfico representa todas las cantidades involucradas en el
modelo mediante nodos de una gráfica dirigida, el modelo representa el supuesto
que dados los nodos padres <span class="math inline">\(padres(v)\)</span> cada nodo es independiente del resto de
los nodos a excepción de sus descendientes.</p>
<p>Los nodos en las gráficas se clasifican en 3 tipos:</p>
<ul>
<li><p><strong>Constantes</strong> fijas por el diseño del estudio, siempre son nodos sin padres.</p></li>
<li><p><strong>Estocásticos</strong> son variables a los que se les asigna una distribución.</p></li>
<li><p><strong>Determinísticos</strong> son funciones lógicas de otros nodos.</p></li>
</ul>
<p>Los supuestos de independencia condicional que representa la gráfica implican
que la distribución conjunta de todas las cantidades V tiene una factorización
en términos de la distribución condicional <span class="math inline">\(p(v|padres(v))\)</span> de tal manera que:
<span class="math display">\[p(V) = \prod p(v|padres(v))\]</span></p>
<p>Veamos como usar las gráficas para simular de modelos probabilísticos. Los
siguientes ejemplos están escritos con base en <span class="citation">Gelman and Hill (<a href="#ref-gelman-hill">2007</a>)</span>.</p>
<div id="ejemplo-de-simulacion-discreta-predictiva" class="section level4 unnumbered">
<h4>Ejemplo de simulación discreta predictiva</h4>
<p>La probabilidad de que un bebé sea niña o niño es <span class="math inline">\(48.8\%\)</span> y <span class="math inline">\(51.2\%\)</span>
respectivamente. Supongamos que hay 400 nacimientos en un hospital en un año
dado. ¿Cuántas niñas nacerán?</p>
<p>Comencemos viendo el modelo gráfico asociado.</p>
<p><img src="imagenes/ninas_1.png" /></p>
<p>La gráfica superior muestra todas las variables relevantes en el problema, y las
dependencias entre ellas. En este caso <span class="math inline">\(n\)</span> es una constante que representa el
número de nacimientos, (<span class="math inline">\(n=400\)</span>), <span class="math inline">\(p=48.8\)</span> es la probabilidad de que un nacimiento
resulte en niña y <span class="math inline">\(k \sim Binomial(p, n)\)</span>. Debido a que el número de éxitos
(nacimientos que resultan en niña) depende de la tasa <span class="math inline">\(p\)</span> y el número de
experimentos <span class="math inline">\(n\)</span>, los nodos que representan a éstas dos últimas variables están
dirigidos al nodo que representa <span class="math inline">\(k\)</span>.</p>
<p>Una vez que tenemos la gráfica es fácil simular del modelo:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(arm)
<span class="kw">library</span>(tidyr)
<span class="kw">set.seed</span>(<span class="dv">918739837</span>)
n_ninas &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">400</span>, <span class="fl">0.488</span>)</code></pre>
<p>esto nos muestra algo que podría ocurrir en <span class="math inline">\(400\)</span> nacimientos. Ahora, para tener
una noción de la distribución simulamos el proceso <span class="math inline">\(1000\)</span> veces:</p>
<pre class="sourceCode r"><code class="sourceCode r">sims_ninas &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">400</span>, <span class="fl">0.488</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()
<span class="kw">mean</span>(sims_ninas)
<span class="co">#&gt; [1] 196</span>
<span class="kw">sd</span>(sims_ninas)
<span class="co">#&gt; [1] 10.1</span>

<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sims_ninas), <span class="dt">binwidth =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-3-1.png" width="350px" /></p>
<p>El histograma de arriba representa la distribución de probabilidad para el
número de niñas y refleja la incertidumbre en los nacimientos.</p>
<p>Podemos agregar complejidad al modelo, por ejemplo con probabilidad <span class="math inline">\(1/125\)</span> un
nacimiento resulta en gemelos fraternales, y para cada uno de los bebés hay una
posibilidad de aproximadamente <span class="math inline">\(49.5\%\)</span> de ser niña. Además la probabilidad de
gemelos idénticos es de <span class="math inline">\(1/300\)</span> y estos a su vez resultan en niñas en
aproximadamente <span class="math inline">\(40.5\%\)</span> de los casos.</p>
<p><img src="imagenes/ninas_2.png" /></p>
<p>Podemos simular 400 nacimientos bajo este
modelo como sigue:</p>
<pre class="sourceCode r"><code class="sourceCode r">tipo_nacimiento &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;unico&quot;</span>, <span class="st">&quot;fraternal&quot;</span>, <span class="st">&quot;identicos&quot;</span>), 
  <span class="dt">size =</span> <span class="dv">400</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>))
n_unico &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;unico&quot;</span>)  <span class="co"># número de nacimientos únicos</span>
n_fraternal &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;fraternal&quot;</span>)
n_identicos &lt;-<span class="st"> </span><span class="dv">400</span> <span class="op">-</span><span class="st"> </span>n_unico <span class="op">-</span><span class="st"> </span>n_fraternal
n_ninas &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_unico, <span class="fl">0.488</span>) <span class="op">+</span>
<span class="st">           </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n_fraternal, <span class="fl">0.495</span>) <span class="op">+</span><span class="st"> </span><span class="co"># en cada nacimiento hay 2 bebés</span>
<span class="st">           </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_identicos, <span class="fl">0.405</span>)
n_ninas
<span class="co">#&gt; [1] 183</span></code></pre>
<p>Repetimos la simulación 1000 veces para aproximar la distribución de número de
niñas en 400 nacimientos.</p>
<pre class="sourceCode r"><code class="sourceCode r">modelo2 &lt;-<span class="st"> </span><span class="cf">function</span>(){
    tipo_nacimiento &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;unico&quot;</span>, <span class="st">&quot;fraternal&quot;</span>, <span class="st">&quot;identicos&quot;</span>), 
        <span class="dt">size =</span> <span class="dv">400</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>))
    <span class="co"># número de nacimientos de cada tipo</span>
    n_unico &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;unico&quot;</span>)  <span class="co"># número de nacimientos únicos</span>
    n_fraternal &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;fraternal&quot;</span>)
    n_identicos &lt;-<span class="st"> </span><span class="dv">400</span> <span class="op">-</span><span class="st"> </span>n_unico <span class="op">-</span><span class="st"> </span>n_fraternal
    <span class="co"># simulamos para cada tipo de nacimiento</span>
    n_ninas &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_unico, <span class="fl">0.488</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n_fraternal, <span class="fl">0.495</span>) <span class="op">+</span><span class="st"> </span><span class="co"># en cada nacimiento hay 2 bebés</span>
<span class="st">    </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_identicos, <span class="fl">0.405</span>)
  n_ninas
}

sims_ninas_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">modelo2</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()
<span class="kw">mean</span>(sims_ninas_<span class="dv">2</span>)
<span class="co">#&gt; [1] 198</span>
<span class="kw">sd</span>(sims_ninas_<span class="dv">2</span>)
<span class="co">#&gt; [1] 10.2</span>
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sims_ninas_<span class="dv">2</span>), <span class="dt">binwidth =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-6-1.png" width="350px" /></p>
</div>
<div id="ejemplo-de-simulacion-continua-predictiva" class="section level4">
<h4><span class="header-section-number">8.2.0.1</span> Ejemplo de simulación continua predictiva</h4>
<p>El 52% de los adultos en EUA son mujeres y el 48% hombres, las estaturas de
los hombres se distribuyen aproximadamente normal con media 175 cm y desviación
estándar de 7.37 cm, en el caso de las mujeres la distribución es
aproximadamente normal con media 161.80 cm y desviación estándar de 6.86 cm.
Supongamos que seleccionamos 10 adultos al azar, ¿cuál es el modelo gráfico
asociado? ¿qué podemos decir del promedio de estatura?</p>
<pre class="sourceCode r"><code class="sourceCode r">sexo &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.52</span>)
altura &lt;-<span class="st"> </span><span class="kw">rnorm</span>(sexo, <span class="dt">mean =</span> <span class="fl">161.8</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">175</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>), 
  <span class="dt">sd =</span> <span class="fl">6.86</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">7.37</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))
<span class="kw">mean</span>(altura)
<span class="co">#&gt; [1] 172</span></code></pre>
<p>Simulamos la distribución de la altura promedio:</p>
<pre class="sourceCode r"><code class="sourceCode r">mediaAltura &lt;-<span class="st"> </span><span class="cf">function</span>(){
  sexo &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.52</span>)
  altura &lt;-<span class="st"> </span><span class="kw">rnorm</span>(sexo, <span class="dt">mean =</span> <span class="fl">161.8</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">175</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>), 
    <span class="dt">sd =</span> <span class="fl">6.86</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">7.37</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))
}
sims_alturas &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">mediaAltura</span>()) 
media_alturas &lt;-<span class="st"> </span>sims_alturas <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(mean)
<span class="kw">mean</span>(media_alturas)
<span class="co">#&gt; [1] 168</span>
<span class="kw">sd</span>(media_alturas)
<span class="co">#&gt; [1] 3.05</span>
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> media_alturas), <span class="dt">binwidth =</span> <span class="fl">1.2</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-8-1.png" width="350px" /></p>
<p>¿Y que podemos decir de la altura máxima?</p>
<pre class="sourceCode r"><code class="sourceCode r">alt_max &lt;-<span class="st"> </span>sims_alturas <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(max)
<span class="kw">qplot</span>(alt_max, <span class="dt">geom =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">1.5</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-9-1.png" width="350px" /></p>
<p><img src="imagenes/manicule2.jpg" /> Supongamos que una compañía cambia la tecnología
usada para producir una cámara, un estudio estima que el ahorro en la producción
es de $5 por unidad con un error estándar de $4. Más aún, una proyección
estima que el tamaño del mercado (esto es, el número de cámaras que se venderá)
es de 40,000 con un error estándar de 10,000. Suponiendo que las dos fuentes de
incertidumbre son independientes, usa simulación de variables aleatorias
normales para estimar el total de dinero que ahorrará la compañía, calcula un
intervalo de confianza.</p>
</div>
<div id="ejemplo-de-simulacion-de-un-modelo-de-regresion" class="section level4">
<h4><span class="header-section-number">8.2.0.2</span> Ejemplo de simulación de un modelo de regresión</h4>
<p>En regresión utilizamos simulación para capturar tanto la incertidumbre en la
predicción (término de error en el modelo) como la incertidumbre en la inferencia
(errores estándar de los coeficientes e incertidumbre del error residual).</p>
<p>Comenzamos con un ejemplo en el que simulamos únicamente <strong>incertidumbre en la
predicción</strong>.</p>
<p>Supongamos que el puntaje de un niño de tres años en una prueba cognitiva esta
relacionado con las características de la madre, el siguiente modelo resume la
diferencia en los puntajes promedio de los niños cuyas madres se graduaron
de preparatoria y los que no.</p>
<p><span class="math display">\[y_i= \beta_0 + \beta_1 X_{i1} + \epsilon_i\]</span></p>
<ul>
<li>donde <span class="math inline">\(y_i\)</span> es el puntaje del <span class="math inline">\(i\)</span>-ésimo niño,</li>
<li><span class="math inline">\(X_{i1}\)</span> es una variable binaria que indica si la madre se graduó de
preparatoria (codificado como <span class="math inline">\(1\)</span>) o no (codificado como <span class="math inline">\(0\)</span>), y</li>
<li><span class="math inline">\(\epsilon_i\)</span> son los error aleatorios, estos son
independientes con distribución normal <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>.</li>
</ul>
<p>Ahora consideremos el problema de simular el puntaje de <span class="math inline">\(50\)</span> niños <span class="math inline">\(30\)</span> con madres
que terminaron la preparatoria y <span class="math inline">\(20\)</span> cuyas madres no terminaron. Los coeficientes
que usaremos son:</p>
<p><span class="math display">\[\beta_0 = 78\]</span>
<span class="math display">\[\beta_1 = 12\]</span>
<span class="math display">\[\sigma = 20\]</span></p>
<p>El modelo gráfico asociado sería como sigue:</p>
<p><img src="imagenes/regresion.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">vector_mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">78</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span>, <span class="dv">30</span>), <span class="kw">rep</span>(<span class="dv">78</span>, <span class="dv">20</span>)) <span class="co"># beta_0 + beta_1 X</span>
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, vector_mu, <span class="dv">20</span>)
sims_y &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">2000</span>, <span class="kw">rnorm</span>(<span class="dv">50</span>, vector_mu, <span class="dv">20</span>))</code></pre>
<p>Podemos calcular la media y su intervalo de confianza:</p>
<pre class="sourceCode r"><code class="sourceCode r">medias &lt;-<span class="st"> </span>sims_y <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(mean)
<span class="kw">quantile</span>(medias, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
<span class="co">#&gt;  2.5% 97.5% </span>
<span class="co">#&gt;  79.7  90.8</span>

<span class="kw">qplot</span>(medias, <span class="dt">geom =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">1.5</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-12-1.png" width="350px" /></p>
<p>Supongamos ahora que nos interesa incorporar que tenemos <strong>incertidumbre en los
coeficientes de regresión</strong>, y expresamos nuestra incertidumbre a través de
distribuciones de probabilidad, ¿cómo sería el modelo gráfico asociado?</p>
<p>Primero suponemos que <span class="math inline">\(\sigma^2\)</span> tiene una distribución centrada en <span class="math inline">\(20^2\)</span>,
proporcional a una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(432\)</span> grados de libertad.</p>
<p><span class="math display">\[
\begin{eqnarray*}
\begin{pmatrix}\beta_{0}\\
\beta_{1}
\end{pmatrix} &amp; \sim &amp; N\left[\left(\begin{array}{c}
78\\
12
\end{array}\right), \sigma^2 \left(\begin{array}{cc}
0.01 &amp; -0.01\\
-0.01 &amp; 0.01
\end{array}\right)\right]
\end{eqnarray*}
\]</span></p>
<p>Finalmente, simulamos del modelo incorporando tanto la incertidumbre
correpondiente a la predicción como la incertidumbre en los coeficientes de
regresión.</p>
<ol style="list-style-type: decimal">
<li><p>Simula <span class="math inline">\(\sigma=20\sqrt{(432)/X}\)</span> donde <span class="math inline">\(X\)</span> es una generación de una
distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(432\)</span> grados de libertad.</p></li>
<li><p>Dado <span class="math inline">\(\sigma\)</span> (obtenido del paso anterior), simula <span class="math inline">\(\beta\)</span> de una distribución
normal multivariada con media <span class="math inline">\((77,12)\)</span> y matriz de covarianzas <span class="math inline">\(\sigma^2 V\)</span>.</p></li>
<li><p>Simula <span class="math inline">\(y\)</span> el vector de observaciones usando los parámetros de <span class="math inline">\(1\)</span> y <span class="math inline">\(2\)</span>.</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">simula_parametros &lt;-<span class="st"> </span><span class="cf">function</span>(){
    <span class="co"># empezamos simulando sigma</span>
    sigma &lt;-<span class="st"> </span><span class="dv">20</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="dv">432</span>) <span class="op">/</span><span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">1</span>, <span class="dv">432</span>))
    <span class="co"># la usamos para simular betas</span>
    beta &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">78</span>, <span class="dv">12</span>), 
        <span class="co"># Sigma = sigma ^ 2 * matrix(c(4.2, -4.2, -4.2, 5.4), nrow = 2))</span>
        <span class="dt">Sigma =</span> sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.011</span>, <span class="fl">-0.011</span>, <span class="fl">-0.011</span>, <span class="fl">0.013</span>), <span class="dt">nrow =</span> <span class="dv">2</span>))
    <span class="co"># Simulamos parámetros</span>
    <span class="kw">list</span>(<span class="dt">sigma =</span> sigma, <span class="dt">beta =</span> beta)
}

sims_parametros &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">simula_parametros</span>()) 

<span class="co"># simulamos los puntajes</span>
simula_puntajes &lt;-<span class="st"> </span><span class="cf">function</span>(beta, sigma, <span class="dt">n_hs =</span> <span class="dv">30</span>, <span class="dt">n_nhs =</span> <span class="dv">20</span>){
    vector_mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(beta[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>beta[<span class="dv">2</span>], n_hs), <span class="kw">rep</span>(beta[<span class="dv">1</span>], n_nhs)) <span class="co"># beta_0 + beta_1 X</span>
    obs =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, vector_mu, sigma)
}

sims_puntajes &lt;-<span class="st"> </span><span class="kw">map</span>(sims_parametros, <span class="op">~</span><span class="kw">simula_puntajes</span>(<span class="dt">beta =</span> .[[<span class="st">&quot;beta&quot;</span>]], <span class="dt">sigma =</span> .[[<span class="st">&quot;sigma&quot;</span>]]))
medias_incert &lt;-<span class="st"> </span>sims_puntajes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(mean)

<span class="kw">quantile</span>(medias_incert, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
<span class="co">#&gt;  2.5% 97.5% </span>
<span class="co">#&gt;  79.2  90.9</span>
<span class="kw">qplot</span>(medias_incert, <span class="dt">geom =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-13-1.png" width="350px" /></p>
<p>Los parametros se obtuvieron de ajustar el modelo de regresión lineal.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreign)
kids_iq &lt;-<span class="st"> </span><span class="kw">read.dta</span>(<span class="st">&quot;data/kidiq.dta&quot;</span>)
lm_kid &lt;-<span class="st"> </span><span class="kw">lm</span>(kid_score <span class="op">~</span><span class="st"> </span>mom_hs, kids_iq)
V &lt;-<span class="st"> </span><span class="kw">vcov</span>(lm_kid) <span class="op">/</span><span class="st"> </span><span class="dv">20</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span>
<span class="kw">summary</span>(lm_kid)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = kid_score ~ mom_hs, data = kids_iq)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt; -57.55 -13.32   2.68  14.68  58.45 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)    77.55       2.06   37.67   &lt;2e-16 ***</span>
<span class="co">#&gt; mom_hs         11.77       2.32    5.07    6e-07 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 19.9 on 432 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.0561, Adjusted R-squared:  0.0539 </span>
<span class="co">#&gt; F-statistic: 25.7 on 1 and 432 DF,  p-value: 5.96e-07</span></code></pre>
<p>Podemos usar simulación para calcular intervalos de confianza para <span class="math inline">\(\beta_0\)</span> y
<span class="math inline">\(\beta_1\)</span>,</p>
<pre class="sourceCode r"><code class="sourceCode r">sims_parametros <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(<span class="op">~</span>(.<span class="op">$</span>beta[<span class="dv">1</span>])) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sd</span>()
<span class="co">#&gt; [1] 2.11</span>
sims_parametros <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(<span class="op">~</span>(.<span class="op">$</span>beta[<span class="dv">2</span>])) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sd</span>()
<span class="co">#&gt; [1] 2.3</span></code></pre>
<p>No parece que valga la pena el esfuerzo cuando podemos calcular los intervalos
analíticamente, sin embargo con simulación podemos responder fácilmente otras
preguntas, por ejemplo, la pregunta inicial: ¿cuál es la media esperada para un
conjunto de <span class="math inline">\(50\)</span> niños, <span class="math inline">\(30\)</span> con madres que hicieron preparatoria y <span class="math inline">\(20\)</span> que no? es
fácil de responder con simulación.</p>
<p>Podríamos usar <code>predict()</code> para calcular el estimador puntual de la media en el
examen para los niños:</p>
<pre class="sourceCode r"><code class="sourceCode r">pred_mi_pob &lt;-<span class="st"> </span><span class="kw">predict</span>(lm_kid, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">mom_hs =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">30</span>), 
    <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>))), <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)
<span class="kw">mean</span>(pred_mi_pob<span class="op">$</span>fit)
<span class="co">#&gt; [1] 84.6</span></code></pre>
<p>¿Cómo calculas el error estándar? En este caso se puede resolver pues es una
combinación lineal de los coeficientes del modelo, pero en muchos casos nuestro
objetivo es más complicado que coeficientes o combinaciones lineales de estos.</p>
</div>
<div id="simulacion-de-predicciones-no-lineales" class="section level4">
<h4><span class="header-section-number">8.2.0.3</span> Simulación de predicciones no lineales</h4>
<p>Veamos un ejemplo de las elecciones en el congreso de EUA. Tenemos un modelo
que usaremos para predecir la elección de <span class="math inline">\(1990\)</span> basados en la de <span class="math inline">\(1988\)</span>.</p>
<p><strong>Explicación del problema</strong>. EUA está dividido en <span class="math inline">\(435\)</span> distritos congresionales,
definimos la variable de interés <span class="math inline">\(y_i\)</span> con <span class="math inline">\(i=1,...,n\)</span>, como la participación
del partido Demócrata en el distrito <span class="math inline">\(i\)</span> en <span class="math inline">\(1988\)</span>. La participación se calcula
como el porcentaje de los votos correspondientes a los demócratas del total de
votos que recibieron los demócratas y republicanos, esto es, se excluyen los
votos a otros partidos.</p>
<p>El modelo del que simularemos se construyó usando datos de <span class="math inline">\(1986\)</span> y <span class="math inline">\(1988\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Los datos están almacenados en 3 archivos correspondientes al año</span>
paths &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;data/congress&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)
paths &lt;-<span class="st"> </span><span class="kw">set_names</span>(paths, <span class="kw">basename</span>(paths))

<span class="co"># Leemos los datos y recodificamos variables</span>
congress &lt;-<span class="st"> </span><span class="kw">map_dfr</span>(paths, read.table, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, 
  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>, <span class="dt">.id =</span> <span class="st">&quot;year&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">435</span>, <span class="dv">3</span>),
         <span class="dt">year =</span> <span class="kw">parse_number</span>(year),          <span class="co"># año de la elección</span>
         <span class="dt">incumbency =</span> <span class="kw">ifelse</span>(V3 <span class="op">==</span><span class="st"> </span><span class="dv">-9</span>, <span class="ot">NA</span>, V3), <span class="co"># codificar NAs     </span>
         <span class="dt">dem_share =</span> V4 <span class="op">/</span><span class="st"> </span>(V4 <span class="op">+</span><span class="st"> </span>V5)) <span class="op">%&gt;%</span><span class="st">       </span><span class="co"># participación demócrata</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, year, incumbency, dem_share)

<span class="kw">glimpse</span>(congress)
<span class="co">#&gt; Observations: 1,305</span>
<span class="co">#&gt; Variables: 4</span>
<span class="co">#&gt; $ id         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, ...</span>
<span class="co">#&gt; $ year       &lt;dbl&gt; 1986, 1986, 1986, 1986, 1986, 1986, 1986, 1986, 198...</span>
<span class="co">#&gt; $ incumbency &lt;int&gt; 1, 1, 1, -1, 1, -1, 0, -1, -1, 1, 1, 1, 1, 1, 1, 0,...</span>
<span class="co">#&gt; $ dem_share  &lt;dbl&gt; 0.745, 0.674, 0.696, 0.465, 0.391, 0.358, 0.549, 0....</span>

<span class="co"># datos en forma horizontal</span>
congress_share &lt;-<span class="st"> </span><span class="kw">spread</span>(dplyr<span class="op">::</span><span class="kw">select</span>(congress, <span class="op">-</span>incumbency), year, dem_share)
<span class="kw">colnames</span>(congress_share) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;share_86&quot;</span>, <span class="st">&quot;share_88&quot;</span>, <span class="st">&quot;share_90&quot;</span>)
congress_inc &lt;-<span class="st"> </span><span class="kw">spread</span>(dplyr<span class="op">::</span><span class="kw">select</span>(congress, <span class="op">-</span>dem_share), year, incumbency)
<span class="kw">colnames</span>(congress_inc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;inc_86&quot;</span>, <span class="st">&quot;inc_88&quot;</span>, <span class="st">&quot;inc_90&quot;</span>)

<span class="co"># quitamos NAs</span>
congress_h &lt;-<span class="st"> </span><span class="kw">na.omit</span>(<span class="kw">left_join</span>(congress_share, congress_inc))
<span class="co">#&gt; Joining, by = &quot;id&quot;</span>
<span class="kw">glimpse</span>(congress_h)
<span class="co">#&gt; Observations: 431</span>
<span class="co">#&gt; Variables: 7</span>
<span class="co">#&gt; $ id       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16...</span>
<span class="co">#&gt; $ share_86 &lt;dbl&gt; 0.745, 0.674, 0.696, 0.465, 0.391, 0.358, 0.549, 0.22...</span>
<span class="co">#&gt; $ share_88 &lt;dbl&gt; 0.772, 0.636, 0.665, 0.274, 0.264, 0.334, 0.632, 0.33...</span>
<span class="co">#&gt; $ share_90 &lt;dbl&gt; 0.714, 0.597, 0.521, 0.234, 0.477, 0.256, 0.602, 0.49...</span>
<span class="co">#&gt; $ inc_86   &lt;int&gt; 1, 1, 1, -1, 1, -1, 0, -1, -1, 1, 1, 1, 1, 1, 1, 0, 1...</span>
<span class="co">#&gt; $ inc_88   &lt;int&gt; 1, 1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, 1, 1, ...</span>
<span class="co">#&gt; $ inc_90   &lt;int&gt; 1, 1, 0, -1, 0, -1, 0, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1...</span>

<span class="kw">ggplot</span>(congress_h, <span class="kw">aes</span>(<span class="dt">x =</span> share_<span class="dv">86</span>, <span class="dt">y =</span> share_<span class="dv">88</span>, <span class="dt">color =</span> <span class="kw">factor</span>(inc_<span class="dv">86</span>))) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-17-1.png" width="528" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># quitamos las elecciones que no se compitieron</span>
congress_h &lt;-<span class="st"> </span><span class="kw">filter</span>(congress_h, share_<span class="dv">88</span> <span class="op">!=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>share_<span class="dv">88</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)

fit_<span class="dv">88</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(share_<span class="dv">88</span> <span class="op">~</span><span class="st"> </span>share_<span class="dv">86</span> <span class="op">+</span><span class="st"> </span>inc_<span class="dv">88</span>, <span class="dt">data =</span> congress_h)
<span class="kw">summary</span>(fit_<span class="dv">88</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = share_88 ~ share_86 + inc_88, data = congress_h)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -0.2416 -0.0428 -0.0059  0.0523  0.2263 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)   0.3004     0.0151    19.9   &lt;2e-16 ***</span>
<span class="co">#&gt; share_86      0.3858     0.0278    13.9   &lt;2e-16 ***</span>
<span class="co">#&gt; inc_88        0.1043     0.0069    15.1   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.0774 on 351 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.846,  Adjusted R-squared:  0.845 </span>
<span class="co">#&gt; F-statistic:  965 on 2 and 351 DF,  p-value: &lt;2e-16</span></code></pre>
<p>Simulemos del modelo:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Matriz X</span>
X &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span>, congress_h<span class="op">$</span>share_<span class="dv">88</span>, congress_h<span class="op">$</span>inc_<span class="dv">90</span>)
simula_modelo &lt;-<span class="st"> </span><span class="cf">function</span>(){
    sigma &lt;-<span class="st"> </span><span class="fl">0.08</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="dv">351</span>) <span class="op">/</span><span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">1</span>, <span class="dv">351</span>))
    beta &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="fl">0.30</span>, <span class="fl">0.39</span>, <span class="fl">0.10</span>), 
        <span class="dt">Sigma =</span> sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.04</span>, <span class="fl">-0.07</span>, <span class="fl">0.01</span>, <span class="fl">-0.07</span>, <span class="fl">0.13</span>, <span class="fl">-0.02</span>, <span class="fl">0.01</span>, 
            <span class="fl">-0.02</span>, <span class="fl">0.01</span>), <span class="dt">nrow =</span> <span class="dv">3</span>))
    mu &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta
    <span class="kw">data_frame</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">358</span>, <span class="dt">dem_share =</span> <span class="kw">rnorm</span>(<span class="dv">358</span>, mu, sigma))
}

sims_congress &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">2000</span>, <span class="kw">simula_modelo</span>()) 
sims_congress &lt;-<span class="st"> </span>sims_congress <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>, <span class="dt">each =</span> <span class="dv">358</span>))

<span class="kw">ggplot</span>(sims_congress, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(id, dem_share), <span class="dt">y =</span> dem_share)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">yintercept =</span> <span class="fl">0.5</span>)</code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-19-1.png" width="864" /></p>
<p>Podemos preguntarnos cuántas elecciones ganaron los demócratas en <span class="math inline">\(1990\)</span>:
<span class="math inline">\(\sum I(\tilde{y} &gt; 0.5)\)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">sims_congress <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(sim) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wins =</span> <span class="kw">sum</span>(dem_share <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wins =</span> <span class="kw">mean</span>(wins),
            <span class="dt">median_wins =</span> <span class="kw">median</span>(wins), 
            <span class="dt">sd_wins =</span> <span class="kw">sd</span>(wins))
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   mean_wins median_wins sd_wins</span>
<span class="co">#&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1      202.         202    3.78</span>
sims_congress <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(sim) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wins =</span> <span class="kw">sum</span>(dem_share <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">pull</span>(wins) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">qplot</span>()
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Veamos lo que ocurrió realmente</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(congress_h<span class="op">$</span>share_<span class="dv">90</span> <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)
<span class="co">#&gt; [1] 207</span></code></pre>
<p>La función <code>sim()</code> del paquete <code>arm</code> permite simular de modelos
lineales y lineales generalizados.</p>
<pre class="sourceCode r"><code class="sourceCode r">sim_fit_<span class="dv">88</span> &lt;-<span class="st"> </span>arm<span class="op">::</span><span class="kw">sim</span>(fit_<span class="dv">88</span>, <span class="dt">n.sims =</span> <span class="dv">1000</span>)
sim_fit_<span class="dv">88</span><span class="op">@</span>coef[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]
<span class="co">#&gt;       (Intercept) share_86 inc_88</span>
<span class="co">#&gt;  [1,]       0.317    0.358 0.1078</span>
<span class="co">#&gt;  [2,]       0.300    0.377 0.1057</span>
<span class="co">#&gt;  [3,]       0.288    0.408 0.1109</span>
<span class="co">#&gt;  [4,]       0.302    0.379 0.1078</span>
<span class="co">#&gt;  [5,]       0.302    0.377 0.1086</span>
<span class="co">#&gt;  [6,]       0.297    0.388 0.1042</span>
<span class="co">#&gt;  [7,]       0.283    0.423 0.0978</span>
<span class="co">#&gt;  [8,]       0.307    0.368 0.1095</span>
<span class="co">#&gt;  [9,]       0.305    0.372 0.1077</span>
<span class="co">#&gt; [10,]       0.283    0.430 0.0933</span>
sim_fit_<span class="dv">88</span><span class="op">@</span>sigma[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
<span class="co">#&gt;  [1] 0.0812 0.0799 0.0747 0.0751 0.0807 0.0815 0.0760 0.0766 0.0804 0.0790</span></code></pre>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-gelman-hill">
<p>Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Vol. Analytical methods for social research. New York: Cambridge University Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distribuciones-multivariadas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inferencia-visual.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2018/edit/master/07-simulacion_modelos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["est-computacional-2018.pdf", "est-computacional-2018.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
